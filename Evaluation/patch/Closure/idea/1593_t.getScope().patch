diff --git a/src/com/google/javascript/jscomp/GlobalNamespace.java b/src/com/google/javascript/jscomp/GlobalNamespace.java
index 1cd29f0..f95e51d 100644
--- a/src/com/google/javascript/jscomp/GlobalNamespace.java
+++ b/src/com/google/javascript/jscomp/GlobalNamespace.java
@@ -314,8 +314,9 @@
 
       // If we are traversing the externs, then we save a pointer to the scope
       // generated by them, so that we can do lookups in it later.
-      if (externsRoot != null && n == externsRoot) {
-        externsScope = t.getScope();
+        Scope scope1 = t.getScope();
+        if (externsRoot != null && n == externsRoot) {
+        externsScope = scope1;
       }
 
       String name;
@@ -421,7 +422,7 @@
       }
 
       // We are only interested in global names.
-      Scope scope = t.getScope();
+      Scope scope = scope1;
       if (!isGlobalNameReference(name, scope)) {
         return;
       }
